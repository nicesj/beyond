SET(DNS_SD_LIB dns_sd)

ADD_DEFINITIONS(-D_GNU_SOURCE -DHAVE_IPV6 -DNOT_HAVE_SA_LEN -DUSES_NETLINK -DTARGET_OS_LINUX -fno-strict-aliasing -DHAVE_LINUX -DMDNS_DEBUGMSGS=0)

SET(DNS_SD_SRC mDNSShared/dnssd_clientlib.c
               mDNSShared/dnssd_clientstub.c
               mDNSShared/dnssd_ipc.c)

IF(PLATFORM STREQUAL "android")
    ADD_DEFINITIONS(-D__ANDROID__ -DMDNS_UDS_SERVERPATH="/dev/socket/mdnsd")
    ADD_LIBRARY(${DNS_SD_LIB} SHARED ${DNS_SD_SRC})
    TARGET_LINK_LIBRARIES(${DNS_SD_LIB} c)
ELSE(PLATFORM STREQUAL "android")
    ADD_LIBRARY(${DNS_SD_LIB} STATIC ${DNS_SD_SRC})
ENDIF(PLATFORM STREQUAL "android")

TARGET_INCLUDE_DIRECTORIES(${DNS_SD_LIB} PUBLIC
    ${CMAKE_CURRENT_SOURCE_DIR}/mDNSPosix
    ${CMAKE_CURRENT_SOURCE_DIR}/mDNSShared
)
